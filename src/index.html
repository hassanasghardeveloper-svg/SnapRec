<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; media-src 'self' blob:; img-src 'self' data: blob:;">
  <title>SnapRec</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app">
    <!-- Top Bar -->
    <div class="top-bar">
      <div class="app-title">
        <svg viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="10" fill="url(#redGradient)"/>
          <circle cx="12" cy="12" r="4" fill="white"/>
          <defs>
            <linearGradient id="redGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#ef4444"/>
              <stop offset="100%" style="stop-color:#dc2626"/>
            </linearGradient>
          </defs>
        </svg>
        <span>SnapRec</span>
      </div>
      <div class="window-controls">
        <button class="win-btn" id="settingsBtn" title="Settings">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
        </button>
        <button class="win-btn" id="minimizeBtn" title="Minimize">
          <svg width="12" height="12" viewBox="0 0 12 12"><rect width="12" height="1.5" y="5" rx="0.75" fill="currentColor"/></svg>
        </button>
        <button class="win-btn close" id="closeBtn" title="Close">
          <svg width="12" height="12" viewBox="0 0 12 12"><path d="M1 1l10 10M11 1l-10 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
      </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
      <!-- Left Panel - Capture Controls -->
      <div class="capture-panel widget">
        <div class="widget-header">
          <span>Capture</span>
          <button id="refreshSources" style="background:none;border:none;color:var(--text-secondary);cursor:pointer;padding:4px;" title="Refresh Sources">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <path d="M23 4v6h-6"/>
              <path d="M1 20v-6h6"/>
              <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
            </svg>
          </button>
        </div>
        <div class="widget-body">
          <!-- Quick Action Buttons -->
          <div class="quick-actions" id="quickActions">
            <button class="action-btn" id="recordBtn" title="Start Recording (Ctrl+Shift+R)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <circle cx="12" cy="12" r="4" fill="#ef4444" stroke="none"/>
              </svg>
              <span>Record</span>
            </button>
            <button class="action-btn" id="screenshotBtn" title="Take Screenshot (Ctrl+Shift+S)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5" fill="currentColor"/>
                <path d="M21 15l-5-5L5 21"/>
              </svg>
              <span>Screenshot</span>
            </button>
            <button class="action-btn" id="snipBtn" title="Snipping Tool (Ctrl+Shift+A)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="6" cy="6" r="3"/>
                <path d="M8.12 8.12L12 12"/>
                <path d="M20 4L8.12 15.88"/>
                <path d="M14.47 14.48L20 20"/>
              </svg>
              <span>Snip</span>
            </button>
            <button class="action-btn" id="gifBtn" title="Record GIF">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="2" width="20" height="20" rx="3"/>
                <path d="M8 12h2v4H8z" fill="currentColor" stroke="none"/>
                <path d="M12 12h2v4h-2z" fill="currentColor" stroke="none"/>
                <path d="M16 12v4" stroke-width="2.5"/>
              </svg>
              <span>GIF</span>
            </button>
            <button class="action-btn" id="audioBtn" title="Audio Only Recording">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                <line x1="12" y1="19" x2="12" y2="23"/>
                <line x1="8" y1="23" x2="16" y2="23"/>
              </svg>
              <span>Audio</span>
            </button>
            <button class="action-btn" id="colorPickerBtn" title="Color Picker">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"/>
              </svg>
              <span>Color</span>
            </button>
            <button class="action-btn" id="zoomBtn" title="Zoom Tool">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                <line x1="11" y1="8" x2="11" y2="14"/>
                <line x1="8" y1="11" x2="14" y2="11"/>
              </svg>
              <span>Zoom</span>
            </button>
            <button class="action-btn" id="folderBtn" title="Open Recordings Folder">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
              <span>Folder</span>
            </button>
          </div>

          <!-- Recording Controls -->
          <div class="recording-controls" id="recordingControls">
            <div class="rec-timer">
              <div class="rec-dot"></div>
              <span class="rec-time" id="recTime">00:00:00</span>
            </div>
            <div class="rec-buttons">
              <button class="rec-btn stop" id="stopBtn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                Stop
              </button>
              <button class="rec-btn pause" id="pauseBtn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16" rx="1"/><rect x="14" y="4" width="4" height="16" rx="1"/></svg>
                Pause
              </button>
            </div>
          </div>

          <!-- Options Section -->
          <div class="options-section">
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                  <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
                  <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
                </svg>
                System Audio
              </div>
              <label class="toggle">
                <input type="checkbox" id="systemAudio" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                  <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                </svg>
                Microphone
              </div>
              <label class="toggle">
                <input type="checkbox" id="micAudio" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
                Countdown
              </div>
              <select class="small-select" id="countdownSelect">
                <option value="0">None</option>
                <option value="3" selected>3 sec</option>
                <option value="5">5 sec</option>
                <option value="10">10 sec</option>
              </select>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/>
                  <path d="M13 13l6 6"/>
                </svg>
                Cursor Highlight
              </div>
              <label class="toggle">
                <input type="checkbox" id="cursorHighlight">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                  <circle cx="12" cy="13" r="4"/>
                </svg>
                Webcam Overlay
              </div>
              <label class="toggle">
                <input type="checkbox" id="webcamToggle">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2"/>
                  <path d="M12 8v8"/>
                  <path d="M8 12h8"/>
                </svg>
                Auto-stop
              </div>
              <select class="small-select" id="autoStopSelect">
                <option value="0">Off</option>
                <option value="1">1 min</option>
                <option value="5">5 min</option>
                <option value="10">10 min</option>
                <option value="30">30 min</option>
                <option value="60">1 hour</option>
              </select>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <circle cx="12" cy="12" r="3"/>
                  <line x1="12" y1="2" x2="12" y2="5"/>
                  <line x1="12" y1="19" x2="12" y2="22"/>
                  <line x1="2" y1="12" x2="5" y2="12"/>
                  <line x1="19" y1="12" x2="22" y2="12"/>
                </svg>
                Click Effects
              </div>
              <label class="toggle">
                <input type="checkbox" id="clickEffects">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="2" y="4" width="20" height="16" rx="2"/>
                  <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01"/>
                  <path d="M6 12h12"/>
                  <path d="M6 16h.01M10 16h.01M14 16h.01M18 16h.01"/>
                </svg>
                Keyboard Overlay
              </div>
              <label class="toggle">
                <input type="checkbox" id="keyboardOverlay">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
                Show Timer Overlay
              </div>
              <label class="toggle">
                <input type="checkbox" id="showTimerOverlay" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                  <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                </svg>
                Draw on Screen
              </div>
              <button class="small-btn" id="annotationBtn">Open</button>
            </div>
          </div>

          <!-- Audio Levels -->
          <div class="audio-levels" id="audioLevels">
            <div class="level-row">
              <span class="level-label">System</span>
              <div class="level-bar">
                <div class="level-fill" id="systemLevel"></div>
              </div>
            </div>
            <div class="level-row">
              <span class="level-label">Mic</span>
              <div class="level-bar">
                <div class="level-fill" id="micLevel"></div>
              </div>
            </div>
          </div>

          <!-- Recording Profiles -->
          <div class="profiles-section">
            <div class="section-header">
              <span class="section-title">Quick Profiles</span>
            </div>
            <div class="profiles-grid">
              <button class="profile-btn" data-profile="gaming" title="Gaming: 1080p 60fps, System Audio">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="2" y="6" width="20" height="12" rx="2"/>
                  <circle cx="8" cy="12" r="2"/>
                  <circle cx="16" cy="12" r="2"/>
                </svg>
                <span>Gaming</span>
              </button>
              <button class="profile-btn" data-profile="tutorial" title="Tutorial: 1080p 30fps, Mic + System">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polygon points="10 8 16 12 10 16 10 8"/>
                </svg>
                <span>Tutorial</span>
              </button>
              <button class="profile-btn" data-profile="meeting" title="Meeting: 720p 30fps, Webcam + Mic">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                  <circle cx="9" cy="7" r="4"/>
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
                <span>Meeting</span>
              </button>
              <button class="profile-btn" data-profile="quick" title="Quick: 720p 30fps, No Audio">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                </svg>
                <span>Quick</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Panel -->
      <div class="preview-panel widget">
        <div class="panel-tabs">
          <button class="panel-tab active" data-tab="preview">Preview</button>
          <button class="panel-tab" data-tab="recent">Recent</button>
        </div>

        <!-- Preview Tab -->
        <div class="tab-content active" id="preview-tab">
          <div class="source-selector">
            <div class="source-tabs">
              <button class="source-tab active" data-type="screen">Screens</button>
              <button class="source-tab" data-type="window">Windows</button>
            </div>
            <div class="source-list" id="sourceList"></div>
          </div>
          <div class="preview-area">
            <video id="preview" autoplay muted></video>
            <div class="webcam-overlay bottom-right" id="webcamOverlay">
              <video id="webcamPreview" autoplay muted playsinline></video>
              <div class="webcam-controls">
                <button class="webcam-pos-btn" data-pos="top-left" title="Top Left">TL</button>
                <button class="webcam-pos-btn" data-pos="top-right" title="Top Right">TR</button>
                <button class="webcam-pos-btn" data-pos="bottom-left" title="Bottom Left">BL</button>
                <button class="webcam-pos-btn active" data-pos="bottom-right" title="Bottom Right">BR</button>
              </div>
            </div>
            <div class="preview-overlay">
              <span class="preview-badge" id="previewBadge">Ready</span>
            </div>
          </div>
          <div class="screenshot-result" id="screenshotResult">
            <img id="screenshotImg" src="" alt="Screenshot">
            <div class="screenshot-actions">
              <button class="ss-btn" id="copyScreenshot">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2"/>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                </svg>
                Copy
              </button>
              <button class="ss-btn primary" id="openFolder">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                </svg>
                Open Folder
              </button>
              <button class="ss-btn" id="closeResult">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
                Close
              </button>
            </div>
          </div>
        </div>

        <!-- Recent Tab -->
        <div class="tab-content" id="recent-tab">
          <div class="recent-captures" id="recentCaptures">
            <div class="empty-state">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M21 15l-5-5L5 21"/>
              </svg>
              <p>No recent captures<br>Start recording or take a screenshot</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
      <div class="status-left">
        <div class="status-indicator">
          <div class="status-dot" id="statusDot"></div>
          <span id="statusText">Ready</span>
        </div>
      </div>
      <div class="hotkey-hints">
        <div class="hotkey"><kbd>Ctrl+Shift+S</kbd> Screenshot</div>
        <div class="hotkey"><kbd>Ctrl+Shift+R</kbd> Record</div>
        <div class="hotkey"><kbd>Ctrl+Shift+A</kbd> Snip</div>
      </div>
    </div>

    <!-- Countdown Overlay -->
    <div class="countdown-overlay" id="countdownOverlay">
      <div class="countdown-number" id="countdownNumber">3</div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Settings</h2>
          <button class="modal-close" id="closeModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="setting-group">
            <label>Save Location</label>
            <div class="path-row">
              <input type="text" id="savePath" readonly placeholder="Select a folder...">
              <button id="browsePath">Browse</button>
            </div>
          </div>
          <div class="setting-group">
            <label>Video Quality</label>
            <select id="videoQuality">
              <option value="high">High (1080p)</option>
              <option value="medium">Medium (720p)</option>
              <option value="low">Low (480p)</option>
            </select>
          </div>
          <div class="setting-group">
            <label>Frame Rate</label>
            <select id="fps">
              <option value="60">60 FPS</option>
              <option value="30">30 FPS</option>
              <option value="24">24 FPS</option>
            </select>
          </div>
          <div class="setting-group">
            <label>GIF Frame Rate</label>
            <select id="gifFps">
              <option value="15">15 FPS</option>
              <option value="10">10 FPS</option>
              <option value="5">5 FPS</option>
            </select>
          </div>
          <div class="setting-group">
            <label>Output Format</label>
            <select id="outputFormat">
              <option value="mp4">MP4 (Recommended)</option>
              <option value="webm">WebM</option>
              <option value="avi">AVI</option>
            </select>
          </div>
          <div class="setting-group">
            <label>Watermark Text (optional)</label>
            <input type="text" id="watermarkText" placeholder="Enter watermark text...">
          </div>
          <div class="setting-group">
            <label>Scheduled Recording</label>
            <div class="schedule-row">
              <input type="time" id="scheduleTime" class="schedule-input">
              <button class="schedule-btn" id="scheduleBtn">Schedule</button>
            </div>
            <span class="schedule-status" id="scheduleStatus"></span>
          </div>
        </div>
        <div class="modal-footer">
          <button class="modal-btn secondary" id="cancelSettings">Cancel</button>
          <button class="modal-btn primary" id="saveSettings">Save Changes</button>
        </div>
      </div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>